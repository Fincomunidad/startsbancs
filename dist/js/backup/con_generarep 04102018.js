"use strict";var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Calendar=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleChange=a.handleChange.bind(a),a}return _inherits(t,React.Component),_createClass(t,[{key:"handleChange",value:function(e){}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myCalen)).on("onChange",this.handleChange)}},{key:"render",value:function(){var e="ui calendar "+(0==this.props.visible?" hidden ":"");return React.createElement("div",{className:e,id:this.props.name},React.createElement("div",{className:"field"},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui input left icon"},React.createElement("i",{className:"calendar icon"}),React.createElement("input",{ref:"myCalen",type:"text",name:this.props.name,id:this.props.name,placeholder:"Fecha",onChange:this.handleChange}))))}}]),t}(),Mensaje=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={icon:"send icon",titulo:"Guardar",pregunta:"¿Desea enviar el registro?"},a}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui mini test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel basic button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok basic button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),t}(),InputFieldNumber=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,onChange:function(t){return e.props.onChange(t)},onBlur:function(t){return e.props.onBlur(t)}})))}}]),t}(),SelectDropDown=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a.handleSelectChange=a.handleSelectChange.bind(a),a}return _inherits(t,React.Component),_createClass(t,[{key:"handleSelectChange",value:function(e){this.props.onChange(e),this.setState({value:e.target.value})}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myDrop)).on("change",this.handleSelectChange)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field "+(0==this.props.visible?" hidden ":""),t=this.props.valores.map(function(e,t){return React.createElement("div",{className:"item","data-value":e.value},e.name)}),a="";return"idmovecho"==this.props.id&&(a="data-name"),React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui fluid search selection dropdown"},React.createElement("input",{type:"hidden",ref:"myDrop",value:this.value,name:this.props.id,onChange:this.handleSelectChange}),React.createElement("i",{className:"dropdown icon"}),React.createElement("div",{className:"default text",id:a},"Seleccione"),React.createElement("div",{className:"menu"},t)))}}]),t}(),SelectOption=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a}return _inherits(t,React.Component),_createClass(t,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" inline field ",t=this.props.valores.map(function(e){return React.createElement("option",{value:e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("select",{className:"ui fluid dropdown",ref:"myCombo",name:this.props.id,id:this.props.id,onChange:this.handleSelectChange.bind(this)},React.createElement("option",{value:this.props.valor},"Seleccione"),t))}}]),t}(),Captura=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={csrf:"",idclave:0,catBoveda:[],ocultar:!0,movimiento:0,importe:0,message:"",statusmessage:"hidden",idmov:0,idmovdet:0,existe:0,idmovecho:0,catMov:[],idmovisible:!1,fechaconsulta:"",fechafin:""},a.handleInputChange=a.handleInputChange.bind(a),a.handleonBlur=a.handleonBlur.bind(a),a}return _inherits(t,React.Component),_createClass(t,[{key:"componentWillMount",value:function(){$.ajax({url:base_url+"/api/CarteraV1/bovedas",type:"GET",dataType:"json",success:function(e){console.log(e),this.setState({catBoveda:e.boveda})}.bind(this),error:function(e,t,a){console.log("error",e),console.log("error",a)}.bind(this)})}},{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(_defineProperty({},n,a)),"idmovecho"==n&&this.setState({idmovdet:a})}},{key:"handleonBlur",value:function(e){var t=e.target,a=t.value,n=(t.name,numeral(a).format("0,0.00"));this.setState({importe:n})}},{key:"handleButton",value:function(e,t){if(1==e)this.printReport();else if(3==e){if(0!=this.state.idclave){var a=!1;0==this.state.idmovisible&&(a=!0),this.setState({idmovisible:a})}}else 4==e&&this.findMov()}},{key:"findMov",value:function(){var e=this,t=this.state.idmov,a="";if(""==t&&(t=0),""!=$("#fechaconsulta").val()){var n=$("#fechaconsulta").val().split("/"),i=new Date(n[2],n[1]-1,n[0]);a=moment(i).format("DDMMYYYY")}var s={url:base_url+"api/CarteraV1/getboveda_mov/"+t+"/"+a,type:"GET",dataType:"json"};ajax(s).then(function(t){e.setState({catMov:t.result})},function(e){})}},{key:"printReport",value:function(){if(0!=this.state.idmovdet){var e=this.state.idmovdet,t=this.state.idclave,a=a="bovedarep/"+e,n="0";if(("Movimientos del dia"===$("#data-name").text().substring(0,19)||"Recuperación de Créditos"===$("#data-name").text().substring(0,24)||"Póliza de diario global"===$("#data-name").text().substring(0,23)||"Póliza de diario"===$("#data-name").text().substring(0,16))&&""!=$("#fechaconsulta").val()){var i=$("#fechaconsulta").val().split("/"),s=new Date(i[2],i[1]-1,i[0]);n=moment(s).format("DDMMYYYY")}if("Movimientos del dia"===$("#data-name").text().substring(0,19))a="cajamov/"+e+"/"+n;else if("Recuperación de Créditos"===$("#data-name").text().substring(0,24))a="creditosmov/"+n;else if("Póliza de diario global"===$("#data-name").text().substring(0,23))a="polizadiario/"+n+"/1";else if("Póliza de diario"===$("#data-name").text().substring(0,16))a="polizadiario/"+n;else if("Detalle de boveda"===$("#data-name").text().substring(0,17)||"Movimientos de boveda operativa"===$("#data-name").text().substring(0,31)||"Movimientos de caja operativa"===$("#data-name").text().substring(0,29)){var o="0",l="0";if(""!=$("#fechaconsulta").val()){var r=$("#fechaconsulta").val().split("/"),c=new Date(r[2],r[1]-1,r[0]);o=moment(c).format("DDMMYYYY")}if(""!=$("#fechafin").val()){var u=$("#fechafin").val().split("/"),d=new Date(u[2],u[1]-1,u[0]);l=moment(d).format("DDMMYYYY")}"Detalle de boveda"===$("#data-name").text().substring(0,17)?a="bovedamov/"+t+"/"+o+"/"+l:"Movimientos de boveda operativa"===$("#data-name").text().substring(0,31)?a="bovedaopera/"+t+"/"+o+"/"+l:"Movimientos de caja operativa"===$("#data-name").text().substring(0,29)&&(a="cajaopera/"+o+"/"+l)}else"Cerrado"==this.state.boton?0==this.state.idmovecho&&(a="bovedacierep/"+e):"Cierre Boveda"===$("#data-name").text().substring(0,13)&&(a="bovedacierep/"+e);var m=document.createElement("a");m.href=base_url+"api/ReportV1/"+a,m.target="_blank",document.body.appendChild(m),m.click(),document.body.removeChild(m)}}},{key:"autoReset",value:function(){var e=this;window.clearTimeout(e.timeout),this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},5e3)}},{key:"render",value:function(){var e=this,t=this.state.statusmessage+" close icon";return React.createElement("div",null,React.createElement("div",{className:"ui segment vertical "},React.createElement("div",{className:"row"},React.createElement("h3",{className:"ui rojo header"},"Reportes de Boveda")),React.createElement("div",{className:"ui  basic icon buttons"},React.createElement("button",{className:"ui button","data-tooltip":"Nuevo Registro"},React.createElement("i",{className:"plus square outline icon",onClick:this.handleButton.bind(this,0)})),React.createElement("button",{className:"ui button","data-tooltip":"Actualizar"},React.createElement("i",{className:"refresh icon",onClick:this.handleButton.bind(this,4)})),React.createElement("button",{className:"ui button","data-tooltip":"Formato PDF"},React.createElement("i",{className:"file pdf outline icon",onClick:this.handleButton.bind(this,1)})),React.createElement("button",{className:"ui button","data-tooltip":"Formato Excel"},React.createElement("i",{className:"file excel outline icon",onClick:this.handleButton.bind(this,2)})))),React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:t,onClick:function(t){window.clearTimeout(e.timeout),e.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get bovopen"},React.createElement("form",{className:"ui form formopen",ref:"form"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",{className:"fields"},React.createElement(SelectDropDown,{cols:"four wide",visible:!0,name:"idclave",id:"idclave",label:"Boveda",valor:this.state.idclave,valores:this.state.catBoveda,onChange:this.handleInputChange.bind(this)}),React.createElement("div",{className:"one wide field"}),React.createElement(Calendar,{name:"fechaconsulta",label:"Fecha consulta",valor:this.state.fechaconsulta,onChange:this.handleInputChange.bind(this)}),React.createElement(Calendar,{name:"fechafin",label:"Fecha Final",valor:this.state.fechafin,onChange:this.handleInputChange.bind(this)}),React.createElement(SelectDropDown,{cols:"seven wide",name:"idmovecho",id:"idmovecho",label:"Movimientos",valor:this.state.idmovecho,valores:this.state.catMov,onChange:this.handleInputChange.bind(this)})))))}}]),t}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root"));