"use strict";var _createClass=function(){function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Steps=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var a=this;return React.createElement("a",{className:this.props.valor==this.props.value?"active step":"step",value:this.props.value,onClick:function(e,t){return a.props.onClick(e,t)}},React.createElement("i",{className:this.props.icon}),React.createElement("div",{className:"content"},React.createElement("div",{className:"title"},this.props.titulo),React.createElement("div",{className:"description"})))}}]),t}(),InputField=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field ",a="password"==this.props.id?"password":"text",s="true"==this.props.mayuscula?"mayuscula":"";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{className:s,id:this.props.id,name:this.props.id,type:a,readOnly:this.props.readOnly,value:this.props.valor,placeholder:this.props.placeholder,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),InputFieldFind=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field ";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{id:this.props.id,name:this.props.id,value:this.props.valor,type:"text",placeholder:this.props.placeholder,onChange:function(e){return t.props.onChange(e)}}),React.createElement("i",{className:this.props.icons,onClick:function(e){return t.props.onClick(e,t.props.valor,t.props.id)}})))}}]),a}(),InputFieldNumber=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),Mensaje=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={icon:"send icon",titulo:"Reversa",pregunta:"¿Confirma realizar la reversa de autorización del crédito?"},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"ui mini test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel basic button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok basic button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),a}(),Calendar=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui calendar",id:this.props.name},React.createElement("div",{className:"field"},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui input left icon"},React.createElement("i",{className:"calendar icon"}),React.createElement("input",{ref:"myCalen",type:"text",name:this.props.name,id:this.props.name,placeholder:"Fecha"}))))}}]),t}(),SelectDropDown=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t.handleSelectChange=t.handleSelectChange.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myDrop)).on("change",this.handleSelectChange)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("div",{className:"item","data-value":e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui fluid search selection dropdown"},React.createElement("input",{type:"hidden",ref:"myDrop",value:this.props.valor,name:this.props.id,onChange:this.handleSelectChange}),React.createElement("i",{className:"dropdown icon"}),React.createElement("div",{className:"default text"},"Seleccione"),React.createElement("div",{className:"menu"},t)))}}]),a}(),SelectOption=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t}return _inherits(a,React.Component),_createClass(a,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myCombo)).on("change",this.handleSelectChange.bind(this))}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" inline field ",t=this.props.valores.map(function(e){return React.createElement("option",{value:e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("select",{className:"ui fluid dropdown",ref:"myCombo",name:this.props.id,id:this.props.id,onChange:this.handleSelectChange.bind(this)},React.createElement("option",{value:this.props.valor},"Seleccione"),t))}}]),a}();function Lista(e){var t=e.enca,a=0,s=t.map(function(e){return React.createElement("th",{key:a++},e)});return React.createElement("tr",null,s)}var RecordDetalle=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.handleDeleteRecord=t.handleDeleteRecord.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"handleDeleteRecord",value:function(){var e=this.props.registro.idcredito;this.props;$(".test.modal").modal({closable:!1,onApprove:function(){$.ajax({url:base_url+"/api/CarteraD1/creditosrev/"+e,type:"PUT",dataType:"json",success:function(e){e.status}.bind(this),error:function(e,t,a){console.log("error")}.bind(this)})}}).modal("show")}},{key:"render",value:function(){return React.createElement("tr",null,React.createElement("td",null,this.props.registro.idcredito),React.createElement("td",null,this.props.registro.nombre),React.createElement("td",null,this.props.registro.idpagare),React.createElement("td",null,this.props.registro.monto),React.createElement("td",null,this.props.registro.fecha_aprov),React.createElement("td",{className:" center aligned"},React.createElement("a",{"data-tooltip":"Eliminar autorización"},React.createElement("i",{className:"trash outline icon circular red",onClick:this.handleDeleteRecord}))))}}]),a}(),Table=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=[];this.props.datos.forEach(function(e){t.push(React.createElement(RecordDetalle,{registro:e}))});return React.createElement("div",null,React.createElement("table",{className:"ui selectable celled red table"},React.createElement("thead",null,React.createElement(Lista,{enca:["Numero","Nombre","Pagare","Monto","Fecha aprov"]})),React.createElement("tbody",null,t)))}}]),t}(),Captura=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={blnActivar:!0,blnCreditoColmena:!1,blnCreditoTemporada:!1,csrf:"",message:"",statusmessage:"ui floating hidden message",stepno:1,creditos:[],boton:"Enviar",btnAutoriza:"Autorizar",icons1:"inverted circular search link icon"},t}return _inherits(a,React.Component),_createClass(a,[{key:"componentWillMount",value:function(){var e=$("#csrf").val();this.setState({csrf:e}),$.ajax({url:base_url+"/api/CarteraD1/creditosrev",type:"GET",dataType:"json",success:function(e){this.setState({creditos:e.result})}.bind(this),error:function(e,t,a){console.log("error")}.bind(this)})}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;if(this.setState(_defineProperty({},s,a)),"nivel"===s&&this.setState(function(e,t){return{monto:1e3*e.nivel}}),"idacreditado"===s&&""!=e.target.value){var n="";"idacreditado"===s&&(n="get_acreditado"),n=n+"/"+e.target.value,$.ajax({url:base_url+"/api/CarteraD1/"+n,type:"GET",dataType:"json",success:function(e){"idacreditado"===s&&this.asignaAcreditado(e.acreditado[0])}.bind(this),error:function(e,t,a){console.log("error")}.bind(this)})}}},{key:"handleSubmit",value:function(e){}},{key:"autoReset",value:function(){var e=this;window.clearTimeout(e.timeout),""!=e.state.message&&(this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},5e3))}},{key:"handleSubmitAutoriza2",value:function(e){e.preventDefault();var t=$(".get.solingaut form"),a=t.form("get values"),s=t.form("get value","csrf_bancomunidad_token"),o=this;$(".test.modal").modal({closable:!1,onApprove:function(){$.ajax({url:base_url+"auth/Autho/validateAutUser/10031",type:"POST",dataType:"json",data:{csrf_bancomunidad_token:s,data:a},success:function(e){if("OK"===e.status){o.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",btnAutoriza:"Autoriza2"});var t=$(".get.soling form"),a=t.form("get values"),s=t.form("get value","csrf_bancomunidad_token"),i=this;$(".test.modal").modal({closable:!1,onApprove:function(){$.ajax({url:base_url+"api/CarteraD1/aut_credito",type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:s,data:a},success:function(e){"OK"===e.status&&i.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",btnAutoriza:"Autorizar"})}.bind(this),error:function(e,t,a){if(404===e.status)i.setState({csrf:e.responseJSON.newtoken,message:e.responseJSON.message,statusmessage:"ui negative floating message"});else if(409===e.status){var s="",n=e.responseText.indexOf('{"status"');0!==n&&(s=e.responseText.substring(n));var r=JSON.parse(s);i.setState({csrf:r.newtoken,message:r.message,statusmessage:"ui negative floating message"})}}.bind(this)})}}).modal("show")}}.bind(this),error:function(e,t,a){if(404===e.status)o.setState({csrf:e.responseJSON.newtoken,message:e.responseJSON.message,statusmessage:"ui negative floating message"});else if(409===e.status){var s="",n=e.responseText.indexOf('{"status"');0!==n&&(s=e.responseText.substring(n));var r=JSON.parse(s);o.setState({csrf:r.newtoken,message:r.message,statusmessage:"ui negative floating message"})}}.bind(this)})}}).modal("show")}},{key:"handleSubmitAutoriza",value:function(e){e.preventDefault();var t=$(".get.soling form"),a=t.form("get values"),s=t.form("get value","csrf_bancomunidad_token"),i=this;$(".test.modal").modal({closable:!1,onApprove:function(){$.ajax({url:base_url+"api/CarteraD1/aut_credito",type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:s,data:a},success:function(e){"OK"===e.status&&i.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",btnAutoriza:"Autorizar"})}.bind(this),error:function(e,t,a){if(404===e.status)i.setState({csrf:e.responseJSON.newtoken,message:e.responseJSON.message,statusmessage:"ui negative floating message"});else if(409===e.status){var s="",n=e.responseText.indexOf('{"status"');0!==n&&(s=e.responseText.substring(n));var r=JSON.parse(s);i.setState({csrf:r.newtoken,message:r.message,statusmessage:"ui negative floating message"})}}.bind(this)})}}).modal("show")}},{key:"handleClickNext",value:function(e){this.state.stepno<2&&this.setState(function(e,t){return{stepno:e.stepno+1}})}},{key:"handleClickPrevious",value:function(e){1<this.state.stepno&&this.setState(function(e,t){return{stepno:e.stepno-1}})}},{key:"handleFind",value:function(e,t){if(""!=t){this.setState({icons1:"spinner circular inverted blue loading icon"});var a=this,s={url:base_url+"api/CarteraD1/get_solicitud_credito_ind/"+t,type:"GET",dataType:"json"};ajax(s).then(function(e){a.setState({cataval1:0,cataval2:0}),a.asignaSolicitudCredito(e.solcredito[0]),a.setState({intCheckListReq:e.checklist[0].total,creditos:e.creditos,message:e.message,statusmessage:"ui positive floating message ",boton:"Actualizar",blnActivar:!1,icons1:"inverted circular search link icon"}),a.setState(function(e,t){return{idexiste:idcredito}}),a.autoReset()},function(e){var t=validaError(e);a.setState({csrf:t.newtoken,message:t.message,statusmessage:"ui negative floating message",icons1:"inverted circular search link icon"}),a.asignaSolicitudCreditoNew(),a.autoReset()})}else{this.setState({message:"Ingrese el número de la solicitud de crédito",statusmessage:"ui negative floating message",icons1:"inverted circular search link icon"}),this.autoReset()}}},{key:"handleButton",value:function(e,t){}},{key:"handleState",value:function(e,t){this.setState({stepno:e})}},{key:"render",value:function(){var t=this;new Date;return React.createElement("div",null,React.createElement("div",{className:"ui segment vertical "},React.createElement("div",{className:"row"},React.createElement("h3",{className:"ui rojo header"},"Reversa autorización de créditos"))),React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:"close icon",onClick:function(e){return t.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get solingamor"},React.createElement("form",{className:"ui form formaut",ref:"formaut"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",null,React.createElement(Table,{datos:this.state.creditos})))),React.createElement("div",{className:"ui vertical segment"},React.createElement("div",{className:"ui vertical segment right aligned"},React.createElement("button",{className:"ui labeled icon positive basic button",onClick:this.handleClickPrevious.bind(this)},React.createElement("i",{className:"left chevron icon"})," Anterior "),React.createElement("button",{className:"ui right labeled icon positive basic button",onClick:this.handleClickNext.bind(this)},"Siguiente ",React.createElement("i",{className:"right chevron icon"})," "))))}}]),a}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root")),$(".ui.search").search({type:"category",minCharacters:8,apiSettings:{url:base_url+"api/CarteraD1/find_acreditadosInd?q={query}",onResponse:function(e){var s={results:{}};if(e&&e.result)return $.each(e.result,function(e,t){var a=t.idacreditado||"Sin asignar";if(8<=e)return!1;void 0===s.results[a]&&(s.results[a]={name:a,results:[]}),s.results[a].results.push({title:t.nombre,description:t.idcredito+" : "+t.idpagare})}),s}}});