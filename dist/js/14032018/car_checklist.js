"use strict";var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var InputField=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field ";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{id:this.props.id,name:this.props.id,type:"text",readOnly:this.props.readOnly,value:this.props.valor,placeholder:this.props.placeholder,onChange:function(t){return e.props.onChange(t)}})))}}]),t}(),CheckListaRow=function(e){_inherits(t,React.Component);function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui vertical segment aligned"},React.createElement("div",{className:"field"},this.props.categoria))}}]),t}(),DocumentoRow=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i="iddoc_"+a.props.valor.iddocumento,n=!1;return null!=a.props.valor.fecha&&(n=!0),a.state=_defineProperty({},i,n),a}return _createClass(t,[{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myCheck)).on("onChange",this.handleClick);var e="iddoc_"+this.props.valor.iddocumento,t=!1;null!=this.props.valor.fecha&&(t=!0),$(".get.soling form").form("set values",_defineProperty({},e,t))}},{key:"handleClick",value:function(e){}},{key:"render",value:function(){var e="iddoc_"+this.props.valor.iddocumento,t=!1;null!=this.props.valor.fecha&&(t=!0);var a=1==t?"ui checkbox checked":"ui checkbox";return React.createElement("div",{className:"row"},React.createElement("div",{className:a},React.createElement("input",{type:"checkbox",ref:"myCheck",name:e,id:e,checked:t,className:"hidden",tabIndex:"0",onChange:this.handleClick.bind(this)}),React.createElement("label",null,this.props.valor.descripciond)))}}]),t}(),SelectOption=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a}return _createClass(t,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("option",{value:e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("select",{className:"ui fluid dropdown",ref:"myCombo",name:this.props.id,id:this.props.id,onChange:this.handleSelectChange.bind(this)},React.createElement("option",{value:this.props.valor},"Seleccione"),t))}}]),t}(),CheckBox=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=[],t=null;return this.props.valores.forEach(function(a){a.descripcionc!==t&&e.push(React.createElement(CheckListaRow,{categoria:a.descripcionc,key:a.descripcionc})),e.push(React.createElement(DocumentoRow,{valor:a,key:a.descripciond})),t=a.descripcionc}),React.createElement("div",{className:"ui segment"},e)}}]),t}(),InputFieldFind=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field ",a="true"==this.props.mayuscula?"mayuscula":"";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{className:a,id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,type:"text",placeholder:this.props.placeholder,onChange:function(t){return e.props.onChange(t)}}),React.createElement("i",{className:this.props.icons,onClick:function(t){return e.props.onClick(t,e.props.valor,e.props.name)}})))}}]),t}(),Mensaje=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={icon:"send icon",titulo:"Guardar",pregunta:"¿Desea enviar el registro?"},a}return _createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui mini test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel basic button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok basic button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),t}(),Captura=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={idacreditado:"",idpagare:0,catchecklist:[],catPagares:[],idcredito:"",idchecklist:"",boton:"Enviar",message:"",statusmessage:"ui floating hidden message",icons1:"inverted circular search link icon",icons2:"inverted circular search link icon",activo:0},a}return _createClass(t,[{key:"componentWillMount",value:function(){var e=$("#csrf").val();this.setState({csrf:e})}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,i=t.name;if(this.setState(_defineProperty({},i,a)),"idpagare"==i&&""!=a){var n=this.state.idacreditado,s=this,r={url:base_url+"api/CarteraV1/credito_checklist/"+n+"/"+a,type:"GET",dataType:"json"};window.clearTimeout(this.timeout),ajax(r).then(function(e){s.setState({message:e.message,statusmessage:"ui positive floating message ",catchecklist:e.checklist,idcredito:e.socio[0].idcredito,idchecklist:e.socio[0].idchecklist,nombre:e.socio[0].nombre,icons1:"inverted circular search link icon",icons2:"inverted circular search link icon"}),s.autoReset()},function(e){var t=validaError(e);s.setState({message:t.message,statusmessage:"ui negative floating message",catchecklist:[],icons1:"inverted circular search link icon",icons2:"inverted circular search link icon"}),s.autoReset()})}}},{key:"handleFind",value:function(e,t,a){if("idacreditado"==a){this.setState({idacreditado:t,icons1:"spinner circular inverted loading icon"});var i=this,n={url:base_url+"api/CarteraV1/getcreditos_clist/"+t,type:"GET",dataType:"json"};window.clearTimeout(this.timeout),ajax(n).then(function(e){i.setState({message:e.message,statusmessage:"ui positive floating message ",catPagares:e.check,nombre:e.check[0].nombre,icons1:"inverted circular search link icon",icons2:"inverted circular search link icon",activo:1}),i.autoReset()},function(e){var t=validaError(e);i.setState({message:t.message,statusmessage:"ui negative floating message",catPagares:[],idpagare:0,idactivo:0,icons1:"inverted circular search link icon",icons2:"inverted circular search link icon"}),i.autoReset()})}}},{key:"handleButton",value:function(e,t){if(0==e){this.setState({activo:0,idacreditado:"",idpagare:"",catPagares:[],nombre:"",catchecklist:[]});$(".get.soling form").form("set values",{idpagare:"0"})}else if(0!=this.state.idpagare){var a=this.state.idpagare,i=document.createElement("a");i.href=base_url+"api/ReportD1/pdf_checklist/"+a,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}},{key:"handleSubmit",value:function(e){e.preventDefault(),$(".ui.form.formgen").form({inline:!0,on:"blur",fields:{idpagare:{identifier:"idpagare",rules:[{type:"empty",prompt:"Capture el pagaré"}]},idacreditado:{identifier:"idacreditado",rules:[{type:"empty",prompt:"Capture el no. de acreditado "},{type:"integer[1..9999]",prompt:"Requiere un valor"}]}}}),$(".ui.form.formgen").form("validate form");var t=$(".ui.form.formgen").form("is valid");if(this.setState({message:"",statusmessage:"ui message hidden"}),1==t){var a=$(".get.soling form"),i=a.form("get values"),n=a.form("get value","csrf_bancomunidad_token"),s=this;$(".mini.modal").modal({closable:!1,onApprove:function(){var e={url:base_url+"api/CarteraV1/credito_checklist",type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:n,data:i}};ajax(e).then(function(e){$(".get.soling form").form("set values",{idpagare:"0"});s.setState({idpersona:e.insert_id,csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",boton:"Enviar",idpagare:0,catchecklist:[]}),s.autoReset()},function(e){var t=validaError(e);s.setState({csrf:t.newtoken,message:t.message,statusmessage:"ui negative floating message"}),s.autoReset()})}}).modal("show")}else this.setState({message:"Datos incompletos!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"autoReset",value:function(){var e=this;this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},5e3)}},{key:"render",value:function(){var e,t=this;return React.createElement("div",null,React.createElement("div",{className:"ui segment vertical "},React.createElement("div",{className:"row"},React.createElement("h3",{className:"ui rojo header"},"CheckList")),React.createElement("div",{className:"ui  basic icon buttons"},React.createElement("button",{className:"ui button","data-tooltip":"Nuevo Registro"},React.createElement("i",{className:"plus square outline icon",onClick:this.handleButton.bind(this,0)})),React.createElement("button",{className:"ui button","data-tooltip":"Formato PDF"},React.createElement("i",{className:"file pdf outline icon",onClick:this.handleButton.bind(this,1)})))),React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:"close icon",onClick:function(e){window.clearTimeout(t.timeout),t.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get soling"},React.createElement("form",{className:"ui form formgen",ref:"form",onSubmit:this.handleSubmit.bind(this),method:"post"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",{className:"fields"},React.createElement(InputFieldFind,(_defineProperty(e={icons:this.state.icons1,id:"idacreditado",readOnly:1==this.state.activo||2==this.state.activo?"readOnly":"",cols:"three wide",name:"idacreditado",valor:this.state.idacreditado},"cols","three wide"),_defineProperty(e,"label","Acreditado"),_defineProperty(e,"placeholder","Buscar"),_defineProperty(e,"onChange",this.handleInputChange.bind(this)),_defineProperty(e,"onClick",this.handleFind.bind(this)),e)),React.createElement(SelectOption,{name:"idpagare",cols:"three wide",id:"idpagare",label:"No. Pagaré",valor:this.state.idpagare,valores:this.state.catPagares,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"nombre",cols:"ten wide",label:"Nombre",readOnly:"readOnly",valor:this.state.nombre,onChange:this.handleInputChange.bind(this)})),React.createElement("div",{className:"segment"},React.createElement("div",{className:"two fields"},React.createElement("input",{type:"hidden",name:"idcredito",value:this.state.idcredito}),React.createElement("input",{type:"hidden",name:"idchecklist",value:this.state.idchecklist})),React.createElement(CheckBox,{valores:this.state.catchecklist})),React.createElement("div",{className:"ui vertical segment right aligned"},React.createElement("div",{className:"field"},React.createElement("button",{className:"ui submit bottom primary basic button",type:"submit",name:"action"},React.createElement("i",{className:"send icon"})," ",this.state.boton," "))))))}}]),t}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root"));