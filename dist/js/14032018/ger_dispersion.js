"use strict";var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var InputField=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field ",a="true"==this.props.mayuscula?"mayuscula":"";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{className:a,id:this.props.id,readOnly:this.props.readOnly,name:this.props.id,type:"text",value:this.props.valor,placeholder:this.props.placeholder,onChange:function(t){return e.props.onChange(t)}})))}}]),t}(),InputFieldFind=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a}return _createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field ";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{id:this.props.id,name:this.props.id,value:this.props.valor,type:"text",placeholder:this.props.placeholder,onChange:function(t){return e.props.onChange(t)}}),React.createElement("i",{className:this.props.icons,onClick:function(t){return e.props.onClick(t,e.props.valor,e.props.id)}})))}}]),t}(),InputFieldNumber=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=this,t=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:t},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,onChange:function(t){return e.props.onChange(t)},onBlur:function(t){return e.props.onBlur(t)}})))}}]),t}(),InputFieldNum=function(e){_inherits(t,React.Component);function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _createClass(t,[{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,value:this.props.valor})))}}]),t}(),Mensaje=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={icon:"send icon",titulo:"Guardar",pregunta:"¿Desea enviar el registro?"},a}return _createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui mini test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel basic button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok basic button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),t}(),Calendar=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleChange=a.handleChange.bind(a),a}return _createClass(t,[{key:"handleChange",value:function(e){console.log(e)}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myCalen)).on("onChange",this.handleChange)}},{key:"render",value:function(){return React.createElement("div",{className:"ui calendar",id:this.props.name},React.createElement("div",{className:"field"},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui input left icon"},React.createElement("i",{className:"calendar icon"}),React.createElement("input",{ref:"myCalen",type:"text",name:this.props.name,id:this.props.name,value:this.props.valor,placeholder:"Fecha",onChange:this.handleChange}))))}}]),t}(),SelectDropDown=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a.handleSelectChange=a.handleSelectChange.bind(a),a}return _createClass(t,[{key:"handleSelectChange",value:function(e){this.props.onChange(e),this.setState({value:e.target.value})}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myDrop)).on("change",this.handleSelectChange)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("div",{className:"item","data-value":e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui fluid search selection dropdown"},React.createElement("input",{type:"hidden",ref:"myDrop",value:this.value,name:this.props.id,onChange:this.handleSelectChange}),React.createElement("i",{className:"dropdown icon"}),React.createElement("div",{className:"default text"},"Seleccione"),React.createElement("div",{className:"menu"},t)))}}]),t}(),SelectOption=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={value:""},a}return _createClass(t,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("option",{value:e.value,"data-cuenta":e.idcuenta},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("select",{className:"ui fluid dropdown",ref:"myCombo",name:this.props.id,id:this.props.id,onChange:this.handleSelectChange.bind(this)},React.createElement("option",{value:this.props.valor},"Seleccione"),t))}}]),t}(),Captura=function(e){_inherits(t,React.Component);function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={catPagares:[],catBancos:[],activo:0,idcredito:0,idacreditado:"",nombre:"",idpagare:"",colmena:"",grupo:"",fecha_aprov:"",monto:0,movimiento:"",csrf:"",message:"",importe:0,importeletra:"",statusmessage:"ui floating hidden message",idbancodet:"",idahorro:0,numero_cuenta:"",cheque_ref:"",afavor:"",icons1:"inverted circular search link icon"},a.handleClickMessage=a.handleClickMessage.bind(a),a.handleonBlur=a.handleonBlur.bind(a),a}return _createClass(t,[{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;if(this.setState(_defineProperty({},n,a)),"movimiento"==n&&"10"==a){var i=this,r={url:base_url+"api/generalv1/bancosall",type:"GET",dataType:"json"};ajax(r).then(function(e){i.setState({catBancos:e.result,idbancodet:""});$(".get.disper form").form("set values",{idbancodet:""})},function(e){validaError(e)})}else if("idpagare"==n){var s=this.state.idacreditado,o=this.state.catPagares.filter(function(e){return e.value==a&&e.idacreditado==s});""!=o?this.setState({colmena:o[0].nomcolmena,grupo:o[0].nomgrupo,fecha_aprov:o[0].fecha_aprov,monto:numeral(o[0].monto).format("0,0.00"),idahorro:o[0].idahorro,numero_cuenta:o[0].numero_cuenta}):this.setState({colmena:"",grupo:"",fecha_aprov:"",monto:0,idahorro:0,numero_cuenta:""})}}},{key:"handleonBlur",value:function(e){var t=e.target,a=t.value,n=t.name,i=numeral(a).format("0,0.00");this.setState(_defineProperty({},n,i))}},{key:"componentWillMount",value:function(){var e=$("#csrf").val();this.setState({csrf:e})}},{key:"handleFind",value:function(e,t,a){"idacreditado"==a&&this.setState({idacredita:t,icons1:"spinner circular inverted blue loading icon"});var n=this,i={url:base_url+"/api/CarteraV1/getCreditos_cat/"+t,type:"GET",dataType:"json"};ajax(i).then(function(e){n.setState({nombre:e.result[0].nombre,afavor:e.result[0].nombre,idcredito:e.result[0].idcredito,catPagares:e.result,message:e.message,statusmessage:"ui floating positive message",activo:1,icons1:"inverted circular search link icon"}),n.autoReset()},function(e){validaError(e);n.setState({catPagares:[],idpagare:"",colmena:"",grupo:"",fecha_aprov:"",monto:0,idcredito:0,message:"Acreditado sin pagares por dispersar",nombre:"",statusmessage:"ui negative floating message",icons1:"inverted circular search link icon"});$(".get.disper form").form("set values",{idpagare:""});n.autoReset()})}},{key:"handleSubmit",value:function(e){e.preventDefault(),$(".ui.form.formdis").form({inline:!0,on:"blur",fields:{idacreditado:{identifier:"idacreditado",rules:[{type:"empty",prompt:"Requiere un valor"}]},idpagare:{identifier:"idpagare",rules:[{type:"empty",prompt:"Requiere un valor"}]},colmena:{identifier:"colmena",rules:[{type:"empty",prompt:"Requiere un valor"}]},grupo:{identifier:"grupo",rules:[{type:"empty",prompt:"Requiere un valor"}]},fecha_aprov:{identifier:"fecha_aprov",rules:[{type:"empty",prompt:"Requiere un valor"}]},movimiento:{identifier:"movimiento",rules:[{type:"empty",prompt:"Seleccione el movimiento"}]},idbancodet:{identifier:"idbancodet",rules:[{type:"empty",prompt:"Seleccione el banco"}]},numero_cuenta:{identifier:"numero_cuenta",rules:[{type:"empty",prompt:"Requiere un valor"}]},cheque_ref:{identifier:"cheque_ref",rules:[{type:"empty",prompt:"Requiere un valor"}]},afavor:{identifier:"afavor",rules:[{type:"empty",prompt:"Requiere un valor"}]},importe:{identifier:"importe",rules:[{type:"empty",prompt:"Requiere un valor"}]},monto:{identifier:"monto",rules:[{type:"empty",prompt:"Requiere un valor"}]},match:{identifier:"importe",rules:[{type:"match[monto]",prompt:"Importes diferentes!"}]}}}),$(".ui.form.formdis").form("validate form");var t=$(".ui.form.formdis").form("is valid"),a=this.state.idacreditado,n=this.state.idpagare;if(""==this.state.catPagares.filter(function(e){return e.value==n&&e.idacreditado==a})&&(this.setState({colmena:"",grupo:"",fecha_aprov:"",monto:0,idahorro:0,numero_cuenta:""}),t=!1),0==this.state.monto&&0==this.state.importe&&(t=!1),this.setState({message:"",statusmessage:"ui floating hidden message"}),1==t){var i=$(".get.disper form"),r=i.form("get values"),s=i.form("get value","csrf_bancomunidad_token"),o=this,l=this.state.idcredito;$(".mini.modal").modal({closable:!1,onApprove:function(){var e={url:base_url+"api/CarteraV1/credito_dis/"+l,type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:s,data:r}};ajax(e).then(function(e){var t=o.state.idpagare,a=o.state.catPagares.filter(function(e){return e.value!=t});o.setState({idpagare:"",csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",catPagares:a,monto:0,importe:0,colmena:"",grupo:"",fecha_aprov:"",idahorro:0,numero_cuenta:"",cheque_ref:"",afavor:"",importeletra:""});$(".get.soling form").form("set values",{idpagare:""});o.autoReset()},function(e){var t=validaError(e);o.setState({csrf:t.newtoken,message:t.message,statusmessage:"ui negative floating message"}),o.autoReset()})}}).modal("show")}else this.setState({message:"Datos incompletos!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"handleButton",value:function(e,t){0==e&&this.setState({activo:0})}},{key:"handleClickMessage",value:function(e){this.setState(function(e){return{message:"",statusmessage:"ui message hidden"}})}},{key:"autoReset",value:function(){var e=this;window.clearTimeout(e.timeout),this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},5e3)}},{key:"render",value:function(){var e=this,t=null;return"10"==this.state.movimiento?t=React.createElement("div",{className:"fields"},React.createElement(SelectOption,{id:"idbancodet",cols:"three wide",label:"Banco",valor:this.state.idbancodet,valores:this.state.catBancos,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"cheque_ref",cols:"two wide",label:"No de Cheque",valor:this.state.cheque_ref,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"afavor",cols:"eleven wide",label:"A favor de",valor:this.state.afavor,onChange:this.handleInputChange.bind(this)})):(this.state.movimiento="01")&&(t=React.createElement("div",{className:"fields"},React.createElement("input",{id:"idahorro",readOnly:"readOnly",name:"idahorro",type:"hidden",value:this.state.idahorro}),React.createElement(InputField,{id:"numero_cuenta",readOnly:"readOnly",cols:"three wide",label:"Cuenta ",valor:this.state.numero_cuenta,onChange:this.handleInputChange.bind(this)}))),React.createElement("div",null,React.createElement("div",{className:"ui segment vertical"},React.createElement("div",{className:"row"},React.createElement("h3",{className:"ui rojo header"},"Dispersión de créditos")),React.createElement("div",{className:"ui basic icon buttons"},React.createElement("button",{className:"ui button","data-tooltip":"Nuevo Registro"},React.createElement("i",{className:"plus square outline icon",onClick:this.handleButton.bind(this,0)})),React.createElement("button",{className:"ui button","data-tooltip":"Formato PDF"},React.createElement("i",{className:"file pdf outline icon",onClick:this.handleButton.bind(this,1)}))),React.createElement("div",{className:"ui basic right floated icon buttons"},React.createElement("button",{className:"ui button","data-tooltip":"Vista"},React.createElement("i",{className:"list icon",onClick:this.handleButton.bind(this,0)})))),React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:"close icon",onClick:function(t){return e.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get disper"},React.createElement("form",{className:"ui form formdis",ref:"form",onSubmit:this.handleSubmit.bind(this),method:"post"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",{className:1===this.state.activo?"disablediv":""},React.createElement("div",{className:"fields"},React.createElement(InputFieldFind,{icons:this.state.icons1,id:"idacreditado",cols:"three wide",mayuscula:"true",name:"idacreditado",valor:this.state.idacreditado,label:"Acreditado",placeholder:"Buscar",onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{id:"nombre",cols:"thirteen wide",label:"Nombre",readOnly:"readOnly",valor:this.state.nombre,onChange:this.handleInputChange.bind(this)}))),React.createElement("div",{className:0===this.state.activo?"disablediv":""},React.createElement("div",{className:"fields"},React.createElement(SelectOption,{id:"idpagare",cols:"three wide",label:"Pagaré",valor:this.state.idpagare,valores:this.state.catPagares,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"colmena",cols:"five wide",label:"Colmena",readOnly:"readOnly",valor:this.state.colmena,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"grupo",cols:"two wide",label:"Grupo",readOnly:"readOnly",valor:this.state.grupo,onChange:this.handleInputChange.bind(this)}),React.createElement(InputField,{id:"fecha_aprov",cols:"three wide",label:"Fec. aprobación",readOnly:"readOnly",valor:this.state.fecha_aprov,onChange:this.handleInputChange.bind(this)}),React.createElement(InputFieldNum,{id:"monto",label:"Monto",readOnly:"readOnly",valor:this.state.monto,onChange:this.handleInputChange.bind(this)})),React.createElement("h4",{className:"ui dividing header"},"Datos"),React.createElement("div",{className:"fields"},React.createElement(SelectOption,{id:"movimiento",cols:"three wide",label:"Movimiento",valor:this.state.movimiento,valores:[{name:"Efectivo",value:"01"},{name:"Cheque",value:"10"}],onChange:this.handleInputChange.bind(this)}),React.createElement(InputFieldNumber,{id:"importe",cols:"three wide",label:"Importe",valor:this.state.importe,onChange:this.handleInputChange.bind(this),onBlur:this.handleonBlur}),React.createElement(InputField,{id:"importeletra",cols:"ten wide",label:"Importe en Letra",readOnly:"readOnly",valor:this.state.importeletra,onChange:this.handleInputChange.bind(this)})),React.createElement("div",null,t),React.createElement("div",{className:"ui vertical segment right aligned"},React.createElement("div",{className:"field"},React.createElement("button",{className:"ui submit bottom primary basic button",type:"submit",name:"action"},React.createElement("i",{className:"send icon"})," Enviar ")))))))}}]),t}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root"));