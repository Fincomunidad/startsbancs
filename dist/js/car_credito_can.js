"use strict";var _createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Steps=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var a=this;return React.createElement("a",{className:this.props.valor==this.props.value?"active step":"step",value:this.props.value,onClick:function(e,t){return a.props.onClick(e,t)}},React.createElement("i",{className:this.props.icon}),React.createElement("div",{className:"content"},React.createElement("div",{className:"title"},this.props.titulo),React.createElement("div",{className:"description"})))}}]),t}(),Calendar=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"ui calendar",id:this.props.name},React.createElement("div",{className:"field"},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui input left icon"},React.createElement("i",{className:"calendar icon"}),React.createElement("input",{ref:"myCalen",type:"text",name:this.props.name,id:this.props.name,placeholder:"Fecha"}))))}}]),t}(),InputField=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field ";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,type:"text",value:this.props.valor,placeholder:this.props.placeholder,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),InputFieldNumber=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,value:this.props.valor,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),InputFieldFind=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field ";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,type:"text",placeholder:this.props.placeholder,onChange:function(e){return t.props.onChange(e)}}),React.createElement("i",{className:this.props.icons,onClick:function(e){return t.props.onClick(e,t.props.valor,t.props.name)}})))}}]),t}(),SelectDropDown=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t.handleSelectChange=t.handleSelectChange.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"handleSelectChange",value:function(e){this.props.onChange(e),this.setState({value:e.target.value})}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myDrop)).on("change",this.handleSelectChange)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("div",{className:"item","data-value":e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui fluid search selection dropdown"},React.createElement("input",{type:"hidden",ref:"myDrop",value:this.value,name:this.props.id,onChange:this.handleSelectChange}),React.createElement("i",{className:"dropdown icon"}),React.createElement("div",{className:"default text"},"Seleccione"),React.createElement("div",{className:"menu"},t)))}}]),a}(),Mensaje=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={icon:"delete icon",titulo:"Eliminar",pregunta:"¿Desea eliminar el registro?"},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"ui mini test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel basic button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok basic button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),a}(),Captura=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={activo:0,idcredito:"",catCreditos:[],idsucursal:"",dias:"",idpagare:"",idpagare2:"",nombre:"",nombre2:"",fecha:"",fecha2:"",fecha_entrega:"",fecha_entrega2:"",importe:"",importe2:"",idbuscar:"",csrf:"",message:"",statusmessage:"ui floating hidden message",stepno:1,boton:"Eliminar",boton2:"Eliminar",disabledboton:"disabled",disabledboton2:"disabled",readOnly:"",icons1:"inverted circular search link icon",icons2:"inverted circular search link icon"},t}return _inherits(a,React.Component),_createClass(a,[{key:"componentWillMount",value:function(){var e=$("#csrf").val();this.setState({csrf:e})}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;if(this.setState(_defineProperty({},n,a)),""!=a&&"idcredito"===n){var i="",s=this;i=(i="getcreditos_eliminar")+"/"+e.target.value;var r={url:base_url+"api/CarteraD1/"+i,type:"GET",dataType:"json"};ajax(r).then(function(e){var t=new Date(e.catCredito[0].fecha_entrega_col);t=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear();var a=new Date(e.catCredito[0].fecha);a=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),s.setState({idpagare:e.catCredito[0].idpagare,nombre:e.catCredito[0].acreditado,importe:e.catCredito[0].monto,fecha:a,fecha_entrega:t});$(".get.soling form").form("set values",{idpagare:e.catCredito[0].idpagare,nombre:e.catCredito[0].acreditado,importe:e.catCredito[0].monto,fecha:a,fecha_entrega:t});s.setState({disabledboton:"",message:e.message,statusmessage:"ui positive floating message ",boton:"Eliminar",icons1:"inverted circular search link icon"})},function(e){s.setState({message:validaError(e).message,statusmessage:"ui negative floating message"})})}else"idcolmena"===n&&""==a&&this.setState({catGrupos:[]})}},{key:"handleSubmit",value:function(e){e.preventDefault(),$(".ui.form.formgen").form({inline:!0,on:"blur",fields:{idcredito:{identifier:"idcredito",rules:[{type:"empty",prompt:"Seleccione el crédito "},{type:"integer[1..999999]",prompt:"Requiere un valor"}]}}}),$(".ui.form.formgen").form("validate form");var t=$(".ui.form.formgen").form("is valid");if(this.setState({message:"",statusmessage:"ui message hidden"}),1==t){var a=$(".get.soling form"),n=a.form("get values"),i=a.form("get value","csrf_bancomunidad_token"),s=this;$(".mini.modal").modal({closable:!1,onApprove:function(){var e={url:base_url+"api/CarteraD1/credito_eliminar",type:"POST",dataType:"json",data:{csrf_bancomunidad_token:i,data:n}};ajax(e).then(function(e){s.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",activo:0,boton:"Eliminar",disabledboton:"disabled"}),s.clearData(),s.autoReset()},function(e){var t=validaError(e);s.setState({csrf:t.newtoken,message:t.message,statusmessage:"ui negative floating message"}),s.autoReset()})}}).modal("show")}else this.setState({message:"Datos incompletos!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"handleSubmitElim",value:function(e){e.preventDefault(),$(".ui.form.formaut").form({inline:!0,on:"blur",fields:{idbuscar:{identifier:"idbuscar",rules:[{type:"empty",prompt:"Escriba el número el crédito "},{type:"integer[1..999999]",prompt:"Requiere un valor"}]}}}),$(".ui.form.formaut").form("validate form");var t=$(".ui.form.formaut").form("is valid");if(this.setState({message:"",statusmessage:"ui message hidden"}),1==t){var a=$(".get.solelim form"),n=a.form("get values"),i=a.form("get value","csrf_bancomunidad_token"),s=this;$(".mini.modal").modal({closable:!1,onApprove:function(){var e={url:base_url+"api/CarteraD1/credito_eliminar2",type:"POST",dataType:"json",data:{csrf_bancomunidad_token:i,data:n}};ajax(e).then(function(e){s.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message ",activo:0,boton2:"Eliminar",disabledboton2:"disabled"}),s.clearData(),s.autoReset()},function(e){var t=validaError(e);s.setState({csrf:t.newtoken,message:t.message,statusmessage:"ui negative floating message"}),s.autoReset()})}}).modal("show")}else this.setState({message:"Datos incompletos..!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"handleFind",value:function(e,t,a){if("idbuscar"==a){var n="",i=this;n=(n="getcreditos_eliminar")+"/"+t;var s={url:base_url+"api/CarteraD1/"+n,type:"GET",dataType:"json"};ajax(s).then(function(e){var t=new Date(e.catCredito[0].fecha_entrega_col);t=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear();var a=new Date(e.catCredito[0].fecha);a=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),i.setState({idpagare2:e.catCredito[0].idpagare,nombre2:e.catCredito[0].acreditado,importe2:e.catCredito[0].monto,fecha2:a,fecha_entrega2:t});$(".get.soling form").form("set values",{idpagare2:e.catCredito[0].idpagare,nombre2:e.catCredito[0].acreditado,importe2:e.catCredito[0].monto,fecha2:a,fecha_entrega2:t});i.setState({disabledboton2:"",message:e.message,statusmessage:"ui positive floating message ",boton2:"Eliminar",icons1:"inverted circular search link icon"})},function(e){i.setState({message:validaError(e).message,statusmessage:"ui negative floating message"})})}else if("dias"==a){this.setState({numero:t,icons2:"spinner circular inverted blue loading icon"});var r=this,o={url:base_url+"api/CarteraD1/getcreditos_sin_entregar/"+t,type:"GET",dataType:"json"};ajax(o).then(function(e){r.setState({idcredito:"",catCreditos:e.catCreditos});$(".get.soling form").form("set values",{idcredito:"",catCreditos:e.catCreditos});r.setState({message:e.message,statusmessage:"ui positive floating message ",boton:"Eliminar",icons1:"inverted circular search link icon"}),r.autoReset()},function(e){var t=validaError(e);r.setState({boton:"Enviar",message:t.message,statusmessage:"ui negative floating message",icons1:"inverted circular search link icon",icons2:"inverted circular search link icon"}),console.log("error"+e),r.clearData(),r.autoReset()})}}},{key:"handleButton",value:function(e,t){1==e&&this.clearData()}},{key:"clearData",value:function(){this.setState({dias:"",idcredito:"",idpagare:"",nombre:"",importe:"",fecha:"",fecha_entrega:"",idbuscar:"",idpagare2:"",nombre2:"",importe2:"",fecha2:"",fecha_entrega2:"",disabledboton:"disabled",disabledboton2:"disabled"});$(".get.soling form").form("set values",{dias:"",idcredito:"",idpagare:"",nombre:"",importe:"",fecha:"",fecha_entrega:"",idbuscar:""});$(".get.soling .ui.dropdown").dropdown("clear")}},{key:"autoReset",value:function(){var e=this;window.clearTimeout(e.timeout),this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},5e3)}},{key:"handleState",value:function(e,t){this.setState({stepno:e})}},{key:"render",value:function(){var t=this;new Date;return"disabled"==this.state.disabledboton?" hidden ":" hidden ",React.createElement("div",null,React.createElement("div",{className:"ui segment vertical"},React.createElement("div",{className:"row"},React.createElement("h3",{className:"ui rojo header"},"Eliminar creditos")),React.createElement("div",{className:"ui secondary menu"},React.createElement("div",{className:"ui  basic icon buttons"},React.createElement("button",{className:"ui button","data-tooltip":"Nuevo"},React.createElement("i",{className:"plus square outline icon",onClick:this.handleButton.bind(this,1)}))))),React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:"close icon",onClick:function(e){window.clearTimeout(t.timeout),t.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get soling"},React.createElement("form",{className:"ui form formgen",ref:"form",onSubmit:this.handleSubmit.bind(this),method:"post"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",{className:"ui mini steps"},React.createElement(Steps,{valor:this.state.stepno,value:"1",icon:"folder outline icon",titulo:"Por número de crédito",onClick:this.handleState.bind(this,1)}),React.createElement(Steps,{valor:this.state.stepno,value:"2",icon:"check circle outline icon",titulo:"Por días transcurridos",onClick:this.handleState.bind(this,2)})),React.createElement("div",{className:2===this.state.stepno?"ui blue segment":"ui blue segment step hidden"},React.createElement("div",{className:"two fields"},React.createElement(InputFieldFind,{cols:"two wide",icons:this.state.icons1,id:"dias",name:"dias",valor:this.state.dias,label:"Dias transcurridos",placeholder:"Buscar",onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)})),React.createElement("div",{className:"field"},React.createElement(SelectDropDown,{name:"idcredito",id:"idcredito",label:"Credito",valor:this.state.idcredito,valores:this.state.catCreditos,onChange:this.handleInputChange.bind(this)})),React.createElement("div",{className:""==this.state.idcredito?"step hidden":""},React.createElement("div",{className:"two fields"},React.createElement(InputField,{cols:"ten wide",readOnly:"readOnly",id:"idpagare",label:"Pagare",name:"idpagare",valor:this.state.idpagare,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"nombre",label:"Nombre",name:"nombre",valor:this.state.nombre,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)})),React.createElement("div",{className:"three fields"},React.createElement(InputFieldNumber,{readOnly:"readOnly",id:"importe",label:"Importe",name:"importe",valor:this.state.importe,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"fecha",label:"Fecha alta",name:"fecha",valor:this.state.fecha,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"fecha_entrega",label:"Fecha entrega",name:"fecha_entrega",valor:this.state.fecha_entrega,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}))),React.createElement("div",{className:"field"},React.createElement("button",{className:"ui submit bottom primary basic button",type:"submit",name:"action",disabled:this.state.disabledboton},React.createElement("i",{className:"send icon"})," ",this.state.boton," ")),React.createElement("div",{className:"row"})))),React.createElement("div",{className:"get solelim"},React.createElement("form",{className:"ui form formaut",ref:"formaut",onSubmit:this.handleSubmitElim.bind(this),method:"POST"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("div",{className:1===this.state.stepno?"ui blue segment":"ui blue segment step hidden"},React.createElement("div",{className:"three fields"},React.createElement(InputFieldFind,{cols:"two wide",icons:this.state.icons1,id:"idbuscar",name:"idbuscar",valor:this.state.idbuscar,label:"No. solicitud",placeholder:"Buscar",onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)})),React.createElement("div",{className:"two fields"},React.createElement(InputField,{cols:"ten wide",readOnly:"readOnly",id:"idpagare2",label:"Pagare",name:"idpagare2",valor:this.state.idpagare2,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"nombre2",label:"Nombre",name:"nombre2",valor:this.state.nombre2,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)})),React.createElement("div",{className:"three fields"},React.createElement(InputFieldNumber,{readOnly:"readOnly",id:"importe2",label:"Importe",name:"importe",valor:this.state.importe2,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"fecha2",label:"Fecha alta",name:"fecha",valor:this.state.fecha2,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)}),React.createElement(InputField,{readOnly:"readOnly",id:"fecha_entrega2",label:"Fecha entrega",name:"fecha_entrega",valor:this.state.fecha_entrega2,onChange:this.handleInputChange.bind(this),onClick:this.handleFind.bind(this)})),React.createElement("div",{className:"field"},React.createElement("button",{className:"ui submit bottom primary basic button",type:"submit",name:"action",disabled:this.state.disabledboton2},React.createElement("i",{className:"send icon"})," ",this.state.boton2," "))))))}}]),a}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root")),$(".ui.search").search({type:"category",minCharacters:4,apiSettings:{url:base_url+"api/CarteraD1/colmena_query?q={query}",onResponse:function(e){var n={results:{}};if(e&&e.result)return $.each(e.result,function(e,t){var a=t.numero||"Sin asignar";if(8<=e)return!1;void 0===n.results[a]&&(n.results[a]={name:a,results:[]}),n.results[a].results.push({title:t.nombre,description:t.empresa+" - "+t.promotor})}),n}}});