"use strict";var _createClass=function(){function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}}();function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var InputField=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field ",a="password"==this.props.id?"password":"text",s="true"==this.props.mayuscula?"mayuscula":"";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui icon input"},React.createElement("input",{className:s,id:this.props.id,name:this.props.id,type:a,value:this.props.valor,placeholder:this.props.placeholder,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),InputFieldNumber=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=(void 0!==this.props.cols?this.props.cols:"")+" field";return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui labeled input"},React.createElement("div",{className:"ui label"},"$"),React.createElement("input",{type:"text",id:this.props.id,name:this.props.id,readOnly:this.props.readOnly,value:this.props.valor,onChange:function(e){return t.props.onChange(e)}})))}}]),t}(),Mensaje=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={icon:"send icon",titulo:"Guardar",pregunta:"Desea enviar el registro?"},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"ui standard test modal scrolling transition hidden"},React.createElement("div",{className:"ui icon header"},React.createElement("i",{className:this.state.icon}),this.state.titulo),React.createElement("div",{className:"center aligned content "},React.createElement("p",null,this.state.pregunta)),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui red cancel button"},React.createElement("i",{className:"remove icon"})," No "),React.createElement("div",{className:"ui green ok  button"},React.createElement("i",{className:"checkmark icon"})," Si ")))}}]),a}(),SelectDropDown=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t.handleSelectChange=t.handleSelectChange.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myDrop)).on("change",this.handleSelectChange)}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" field ",t=this.props.valores.map(function(e){return React.createElement("div",{className:"item","data-value":e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("div",{className:"ui fluid search selection dropdown"},React.createElement("input",{type:"hidden",ref:"myDrop",value:this.props.valor,name:this.props.id,onChange:this.handleSelectChange}),React.createElement("i",{className:"dropdown icon"}),React.createElement("div",{className:"default text"},"Seleccione"),React.createElement("div",{className:"menu"},t)))}}]),a}(),SelectOption=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={value:""},t}return _inherits(a,React.Component),_createClass(a,[{key:"handleSelectChange",value:function(e){this.props.onChange(e)}},{key:"componentDidMount",value:function(){$(ReactDOM.findDOMNode(this.refs.myCombo)).on("change",this.handleSelectChange.bind(this))}},{key:"render",value:function(){var e=(void 0!==this.props.cols?this.props.cols:"")+" inline field ",t=this.props.valores.map(function(e){return React.createElement("option",{value:e.value},e.name)});return React.createElement("div",{className:e},React.createElement("label",null,this.props.label),React.createElement("select",{className:"ui fluid dropdown",ref:"myCombo",name:this.props.id,id:this.props.id,onChange:this.handleSelectChange.bind(this)},React.createElement("option",{value:this.props.valor},"Seleccione"),t))}}]),a}();function Lista(e){var t=e.enca,a=0,s=t.map(function(e){return React.createElement("th",{key:a++},e)});return React.createElement("tr",null,s)}var RecordDetalle=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.handleEditRecord=t.handleEditRecord.bind(t),t.handleInputChange=t.handleInputChange.bind(t),t.state={tel:"",note:"",my_icon:"",estado:""},t}return _inherits(a,React.Component),_createClass(a,[{key:"handleEditRecord",value:function(e){if("Guardar"===this.state.estado){var t=this.props.registro.idpersona,a=$(".get.soling form").form("get value","csrf_bancomunidad_token"),o=this,s=[{idpersona:this.props.registro.idpersona},{telefono:this.props.registro.telefono},{telefono_nota:this.props.registro.telefono_nota}],n={url:base_url+"api/CarteraD1/update_telefono/"+t,type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:a,data:s}};ajax(n).then(function(e){o.setState({csrf_bancomunidad_token:a,my_icon:"",estado:""})},function(e){if("OK"===e.statusText){var t="",a=e.responseText.indexOf('{"status"');0!==a&&(t=e.responseText.substring(a));var s=JSON.parse(t);o.setState({csrf_bancomunidad_token:s.newtoken,my_icon:"",estado:""})}else{console.log("ENTRO REJECT 1");var n=validaError(e);o.setState({csrf:n.newtoken,message:n.message,statusmessage:"ui negative floating message"})}})}else console.log(this.state.estado)}},{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,s=t.name;"t"===s.substring(0,1)&&(this.props.registro.telefono=a,this.setState({tel:a,my_icon:"save icon circular green",estado:"Guardar"})),"n"===s.substring(0,1)&&(this.props.registro.telefono_nota=a,this.setState({note:a,my_icon:"save icon circular green",estado:"Guardar"}))}},{key:"render",value:function(){return React.createElement("tr",null,React.createElement("td",null,this.props.registro.idacreditado),React.createElement("td",null,this.props.registro.nombre),React.createElement("td",null,React.createElement(InputField,{id:"t"+this.props.registro.idacreditado,name:"t"+this.props.registro.idacreditado,mayuscula:"true",valor:this.props.registro.telefono,onChange:this.handleInputChange})),React.createElement("td",null,React.createElement(InputField,{id:"n"+this.props.registro.idacreditado,name:"n"+this.props.registro.idacreditado,mayuscula:"true",valor:this.props.registro.telefono_nota,onChange:this.handleInputChange})),React.createElement("td",null,this.props.registro.col_numero),React.createElement("td",{className:" center aligned"},React.createElement("a",{"data-tooltip":this.state.estado},React.createElement("i",{className:this.state.my_icon,onClick:this.handleEditRecord}))))}}]),a}(),Table=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=[];this.props.datos.forEach(function(e){t.push(React.createElement(RecordDetalle,{registro:e}))});return React.createElement("div",null,React.createElement("table",{className:"ui selectable celled red table"},React.createElement("thead",null,React.createElement(Lista,{enca:["Número","Nombre","Teléfono","Observación","Colmena","Acción"]})),React.createElement("tbody",null,t)))}}]),t}(),Captura=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={directorio:[],opcion:1,opciones:[{value:1,name:"No Socia"},{value:2,name:"Nombre"},{value:3,name:"Colmena"}],txt_buscar:"",id_buscar:0,col_buscar:0,id_socio:0,editar:0,csrf:"",message:"",statusmessage:"ui floating hidden message",btnMostrar:"Mostrar"},t}return _inherits(a,React.Component),_createClass(a,[{key:"componentWillMount",value:function(){var e=$("#csrf").val();this.setState({csrf:e})}},{key:"handleSubmit",value:function(e){e.preventDefault(),$(".ui.form.formgen").form("validate form");$(".ui.form.formgen").form("is valid")}},{key:"handleUpdateData",value:function(e){var t=this.state.id_socio;alert(t),e.preventDefault(),$(".ui.form.formgen").form({inline:!0,on:"blur",fields:{telefono:{identifier:"telefono",rules:[{type:"empty",prompt:"Capture el teléfono"}]},telefono_nota:{identifier:"telefono_nota",rules:[{type:"empty",prompt:"Capture la observación"}]}}}),$(".ui.form.formgen").form("validate form");var a=$(".ui.form.formgen").form("is valid");if(this.setState({message:"",statusmessage:"ui message hidden"}),1==a){var s=$(".get.soling form"),n=s.form("get values"),o=s.form("get value","csrf_bancomunidad_token"),i=this;$(".mini.modal").modal({closable:!1,onApprove:function(){var e={url:base_url+"api/CarteraD1/update_telefono/"+t,type:"PUT",dataType:"json",data:{csrf_bancomunidad_token:o,data:n}};ajax(e).then(function(e){i.setState({csrf:e.newtoken,message:e.message,statusmessage:"ui positive floating message "}),i.autoReset()},function(e){if("OK"===e.statusText){var t="",a=e.responseText.indexOf('{"status"');0!==a&&(t=e.responseText.substring(a));var s=JSON.parse(t);i.setState({csrf:s.newtoken,statusmessage:"ui positive floating message "})}else{console.log("ENTRO REJECT 1");var n=validaError(e);i.setState({csrf:n.newtoken,message:n.message,statusmessage:"ui negative floating message"})}i.autoReset()})}}).modal("show")}else this.setState({message:"Datos incompletos!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"handleDisplayCuentas",value:function(e,t){$(".ui.form.formgen").form("validate form");var a=$(".ui.form.formgen").form("is valid");if(this.setState({message:"",statusmessage:"ui message hidden"}),1==a){var s=$(".get.soling form"),n=s.form("get values"),o=s.form("get value","csrf_bancomunidad_token"),i=this,r="";1===i.state.opcion&&(r="api/GeneralD1/get_directorio/1/"+i.state.id_buscar),2===i.state.opcion&&(r="api/GeneralD1/get_directorio/2/"+i.state.txt_buscar),3===i.state.opcion&&(r="api/GeneralD1/get_directorio/3/"+i.state.col_buscar);var l={url:base_url+r,type:"GET",dataType:"json",data:{csrf_bancomunidad_token:o,data:n}};ajax(l).then(function(e){i.setState({csrf_bancomunidad_token:o,directorio:e.directorio,message:e.message,statusmessage:"ui positive floating message "}),i.autoReset()},function(e){if(console.log("No Entro 1"),"OK"===e.statusText){var t="",a=e.responseText.indexOf('{"status"');0!==a&&(t=e.responseText.substring(a));JSON.parse(t);i.setState({csrf_bancomunidad_token:o,directorio:response.directorio,message:response.message,statusmessage:"ui positive floating message "})}else{console.log("ENTRO REJECT 1");var s=validaError(e);i.setState({csrf:s.newtoken,message:s.message,statusmessage:"ui negative floating message"})}i.autoReset()})}else this.setState({message:"Datos incompletos!",statusmessage:"ui negative floating message"}),this.autoReset()}},{key:"handleOptionState",value:function(e,t){this.setState({opcion:e})}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;if("opcion"===s){var n=parseInt(a);this.setState({opcion:n})}else this.setState(_defineProperty({},s,a))}},{key:"autoReset",value:function(){var e=this;window.clearTimeout(e.timeout),""!=e.state.message&&(this.timeout=window.setTimeout(function(){e.setState({message:"",statusmessage:"ui message hidden"})},2e3))}},{key:"render",value:function(){var t=this;return React.createElement("div",null,React.createElement(Mensaje,null),React.createElement("div",{className:this.state.statusmessage},React.createElement("p",null,React.createElement("b",null,this.state.message)),React.createElement("i",{className:"close icon",onClick:function(e){return t.setState({message:"",statusmessage:"ui message hidden"})}})),React.createElement("div",{className:"get soling"},React.createElement("form",{className:"ui form formgen",ref:"form",onSubmit:this.handleSubmit.bind(this),method:"post"},React.createElement("input",{type:"hidden",name:"csrf_bancomunidad_token",value:this.state.csrf}),React.createElement("input",{type:"hidden",name:"id_socio",value:this.state.id_socio}),React.createElement("div",{className:"three fields"},React.createElement(SelectOption,{name:"opcion",id:"opcion",label:"Filtrar por",valor:this.state.opcion,valores:this.state.opciones,onChange:this.handleInputChange.bind(this)})),React.createElement("div",{className:1===this.state.opcion?"ui blue segment":"ui blue segment step hidden"},React.createElement("div",{className:"field"},React.createElement(InputFieldNumber,{id:"id_buscar",cols:"three wide",label:"No socia",valor:this.state.id_buscar,onChange:this.handleInputChange.bind(this)}),React.createElement("button",{className:"ui right labeled icon positive basic button",onClick:this.handleDisplayCuentas.bind(this,1)},"Mostrar ",React.createElement("i",{className:"right chevron icon"})))),React.createElement("div",{className:2===this.state.opcion?"ui blue segment":"ui blue segment step hidden"},React.createElement("div",{className:"field"},React.createElement(InputField,{id:"txt_buscar",mayuscula:"true",label:"Nombre",valor:this.state.txt_buscar,onChange:this.handleInputChange.bind(this)}),React.createElement("button",{className:"ui right labeled icon positive basic button",onClick:this.handleDisplayCuentas.bind(this,2)},"Mostrar ",React.createElement("i",{className:"right chevron icon"})))),React.createElement("div",{className:3===this.state.opcion?"ui blue segment":"ui blue segment step hidden"},React.createElement("div",{className:"field"},React.createElement(InputFieldNumber,{id:"col_buscar",cols:"three wide",label:"No colmena",valor:this.state.col_buscar,onChange:this.handleInputChange.bind(this)}),React.createElement("button",{className:"ui right labeled icon positive basic button",onClick:this.handleDisplayCuentas.bind(this,3)},"Mostrar ",React.createElement("i",{className:"right chevron icon"})))),React.createElement("div",null,React.createElement(Table,{datos:this.state.directorio})))))}}]),a}();ReactDOM.render(React.createElement(Captura,null),document.getElementById("root"));